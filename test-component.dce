<script lang="ts">
import { getSizeConfig } from '../utils/sizeConfig';
import type { Snippet } from 'svelte';

interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'accent';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  onclick?: (e: MouseEvent) => void;
  children?: Snippet;
}

type SizeConfig = {
  fontSize: string;
  padding: string;
};

let {
  variant = 'primary',
  size = 'md',
  disabled = false,
  onclick,
  children
}: ButtonProps = $props();

let count = $state(0);

const sizeConfig = $derived(getSizeConfig('button', size));

const doubled = $derived(count * 2);

$effect(() => {
  if (count > 10) {
    console.log('Count exceeded 10!');
  }
});

function increment() {
  count++;
}
</script>

<template>
  <div class="button-container">
    {@const tripled = count * 3}
    {@debug count, doubled}

    {#key count}
      <div class="counter">Count: {count}</div>
    {/key}

    <button
      class="btn btn-{variant} btn-{size}"
      disabled={disabled}
      on:click={increment}
    >
      {#if children}
        {@render children()}
      {:else}
        Click me ({count})
      {/if}
    </button>

    <div class="info">
      {@const message = `Doubled: ${doubled}, Tripled: ${tripled}`}
      {@html `<span>${message}</span>`}
    </div>

    <div class="debug-info">
      Size config: {sizeConfig.fontSize}
    </div>
  </div>
</template>

<style>
.button-container {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 0.25rem;
  cursor: pointer;
}

.btn-primary {
  background-color: var(--color-primary);
  color: white;
}

.btn-secondary {
  background-color: var(--color-secondary);
  color: white;
}

.btn-accent {
  background-color: var(--color-accent);
  color: white;
}

.btn-sm {
  font-size: 0.75rem;
}

.btn-md {
  font-size: 1rem;
}

.btn-lg {
  font-size: 1.25rem;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
</style>
